-- 코드를 입력하세요
SELECT
PRODUCT.PRODUCT_CODE,
SUM(OFFLINE_SALE.SALES_AMOUNT) * PRODUCT.PRICE AS SALES
FROM PRODUCT INNER JOIN OFFLINE_SALE
ON PRODUCT.PRODUCT_ID = OFFLINE_SALE.PRODUCT_ID
GROUP BY PRODUCT.PRODUCT_ID
ORDER BY SALES DESC, PRODUCT.PRODUCT_CODE;

-- 21:23~21:31(8분)
-- 상품코드별 매출액(판매가 * 판매량) 합계
-- 매출액 기준 내림차순 정렬, 상품코드 오름차순 정렬
SELECT
p.PRODUCT_CODE,
p.PRICE * s.SALES_AMOUNT SALES
FROM PRODUCT p 
JOIN (
    SELECT 
    o.PRODUCT_ID,
    SUM(o.SALES_AMOUNT) SALES_AMOUNT
    FROM OFFLINE_SALE o
    GROUP BY PRODUCT_ID
) s
ON p.PRODUCT_ID = s.PRODUCT_ID
ORDER BY SALES DESC, p.PRODUCT_CODE;

-- 1번은 서브쿼리없이 바로 씀
-- 2번은 서브쿼리를 썼으나, 그냥했어도 됐음
